var templates=SCNHandlebars.templates=SCNHandlebars.templates||{};templates.sales_nurturing_products=SCNHandlebars.template(function(a,e,n,t,r){function o(a,e){var t,r,o="";return o+="\n            Welcome back ",(r=n.owner_name)?t=r.call(a,{hash:{},data:e}):(r=a&&a.owner_name,t=typeof r===v?r.call(a,{hash:{},data:e}):r),o+=g(t)+"\n        "}function s(){return"\n            Welcome back!\n        "}function c(a,e){var t,r,o="";return o+='\n            <div class="bk-table sn-product" data-title="',(r=n.title)?t=r.call(a,{hash:{},data:e}):(r=a&&a.title,t=typeof r===v?r.call(a,{hash:{},data:e}):r),o+=g(t)+'">\n                <div class="scn-bk-tbody">\n                    <div class="scn-bk-products scn-bk-tr">\n                        <div class="scn-bk-image scn-bk-td">\n                            <a target="_blank" href="',(r=n.url)?t=r.call(a,{hash:{},data:e}):(r=a&&a.url,t=typeof r===v?r.call(a,{hash:{},data:e}):r),o+=g(t)+'" class="bk-view-detail" data-handle="',(r=n.handle)?t=r.call(a,{hash:{},data:e}):(r=a&&a.handle,t=typeof r===v?r.call(a,{hash:{},data:e}):r),o+=g(t)+'">\n                                <div class="bk-image">\n                                    <img src="',(r=n.medium_image_url)?t=r.call(a,{hash:{},data:e}):(r=a&&a.medium_image_url,t=typeof r===v?r.call(a,{hash:{},data:e}):r),o+=g(t)+'" alt="',(r=n.title)?t=r.call(a,{hash:{},data:e}):(r=a&&a.title,t=typeof r===v?r.call(a,{hash:{},data:e}):r),o+=g(t)+'">\n                                </div>\n                            </a>\n                        </div>\n                        <div class="scn-bk-name scn-bk-td">\n                            <a target="_blank" href="',(r=n.url)?t=r.call(a,{hash:{},data:e}):(r=a&&a.url,t=typeof r===v?r.call(a,{hash:{},data:e}):r),o+=g(t)+'" class="bk-view-detail" data-handle="',(r=n.handle)?t=r.call(a,{hash:{},data:e}):(r=a&&a.handle,t=typeof r===v?r.call(a,{hash:{},data:e}):r),o+=g(t)+'">\n                                <strong>',(r=n.title)?t=r.call(a,{hash:{},data:e}):(r=a&&a.title,t=typeof r===v?r.call(a,{hash:{},data:e}):r),o+=g(t)+'</strong>\n                            </a>\n                            <div class="select-money">\n                                <div class="scn-bk-money scn-bk-td">\n                                    <strong>\n                                        <span class="bk-price">',t=a&&a.single_variant,t=null==t||t===!1?t:t.price_format,t=typeof t===v?t.apply(a):t,(t||0===t)&&(o+=t),o+="</span>\n                                    </strong>\n                                    ",t=n["if"].call(a,(t=a&&a.single_variant,null==t||t===!1?t:t.compare_at_price),{hash:{},inverse:b.noop,fn:b.program(6,i,e),data:e}),(t||0===t)&&(o+=t),o+='\n                                </div>\n                                <div class="scn-bk-action scn-bk-td">\n                                    ',t=n["if"].call(a,a&&a.select_variant,{hash:{},inverse:b.program(12,u,e),fn:b.program(8,l,e),data:e}),(t||0===t)&&(o+=t),o+='\n                                </div>\n                            </div>\n                        </div>\n                        <div class="sn-welcome-remove">\n                            <a class="btn sn-remove bk-tooltip" data-tooltip="Remove" data-open="X" data-close="Undo this action"></a>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            ',t=n.unless.call(a,a&&a.is_last,{hash:{},inverse:b.noop,fn:b.program(14,h,e),data:e}),(t||0===t)&&(o+=t),o+="\n        "}function i(a){var e,n="";return n+='\n                                    <del>\n                                        <span class="bk-compare">',e=a&&a.single_variant,e=null==e||e===!1?e:e.compare_at_price_format,e=typeof e===v?e.apply(a):e,(e||0===e)&&(n+=e),n+="</span>\n                                    </del>\n                                    "}function l(a,e){var t,r="";return r+='\n                                        <!--More than 2 variants-->\n                                        <select class="bk-selection" name="id[]">\n                                            ',t=n.each.call(a,a&&a.variants,{hash:{},inverse:b.noop,fn:b.program(9,d,e),data:e}),(t||0===t)&&(r+=t),r+="\n                                        </select>\n                                    "}function d(a,e){var t,r,o,s="";return s+="\n                                                <option ",r=n.ifCond||a&&a.ifCond,o={hash:{},inverse:b.noop,fn:b.program(10,p,e),data:e},t=r?r.call(a,a&&a.replaced,"||",a&&a.selected,o):_.call(a,"ifCond",a&&a.replaced,"||",a&&a.selected,o),(t||0===t)&&(s+=t),s+='\n                                                        data-price="',(r=n.price)?t=r.call(a,{hash:{},data:e}):(r=a&&a.price,t=typeof r===v?r.call(a,{hash:{},data:e}):r),s+=g(t)+'"\n                                                        data-compare="',(r=n.compare_at_price)?t=r.call(a,{hash:{},data:e}):(r=a&&a.compare_at_price,t=typeof r===v?r.call(a,{hash:{},data:e}):r),s+=g(t)+'"\n                                                        value="',(r=n.ref_id)?t=r.call(a,{hash:{},data:e}):(r=a&&a.ref_id,t=typeof r===v?r.call(a,{hash:{},data:e}):r),s+=g(t)+'">\n                                                    ',(r=n.title)?t=r.call(a,{hash:{},data:e}):(r=a&&a.title,t=typeof r===v?r.call(a,{hash:{},data:e}):r),s+=g(t)+"\n                                                </option>\n                                            "}function p(){return"selected"}function u(a){var e,n="";return n+='\n                                        <!--Only one variant-->\n                                        <input type="hidden" name="id[]" value="'+g((e=a&&a.single_variant,e=null==e||e===!1?e:e.ref_id,typeof e===v?e.apply(a):e))+'">\n                                        <!--Default quantity always = 1-->\n                                        <input type="hidden" name="qty[]" value="1" class="qty">\n                                    '}function h(){return'\n                <div class="bk-line"></div>\n            '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,a.helpers),r=r||{};var f,m="",v="function",g=this.escapeExpression,b=this,_=n.helperMissing;return m+='<a id="bk-sn-welcome-a" href="#bk-sn-welcome"></a>\n<div id="bk-sn-welcome">\n    <h3 class="title">\n        ',f=n["if"].call(e,e&&e.owner_name,{hash:{},inverse:b.program(3,s,r),fn:b.program(1,o,r),data:r}),(f||0===f)&&(m+=f),m+='\n    </h3>\n    <div class="content-header">\n        <div class="title-bellow">These items are waiting to be yours.</div>\n        <div class="header-button">\n            <button class="button-top sn-checkout-button ladda-button">\n                <span class="ladda-label">Check out now</span>\n            </button>\n        </div>\n    </div>\n\n    <form action="/cart/add" method="post" id="bk-sn-products-welcome" class="sn-form" data-source-type="sales_nurturing">\n\n        ',f=n.each.call(e,e&&e.products,{hash:{},inverse:b.noop,fn:b.program(5,c,r),data:r}),(f||0===f)&&(m+=f),m+='\n        <div class="button-footer">\n            <div class="button-save-checkout">\n                <button type="submit" class="button-save-cart ladda-button">\n                    <span class="ladda-label">Save to cart</span>\n                </button>\n                <button class="button-bottom sn-checkout-button ladda-button">\n                    <span class="ladda-label">Check out now</span>\n                </button>\n            </div>\n        </div>\n    </form>\n</div>'}),Beeketing.App.register("beeketing",function(a,e){return a.appCode="beeketing",a.init=function(){a.setParams(SCN.Config.apps[a.getAppCode()])},a.canAppStart=function(){return!0},a.start=function(){e.Dispatcher.listenEvent(e.Dispatcher.events.CART.READY,function(){e.Tracker.injectUrlParams&&e.Tracker.injectUrlParams.email_id&&a.SNWelcomePopupInit(e.Tracker.injectUrlParams.email_id)})},a}),Beeketing.App.register("beeketing",function(a,e){var n=SCNjQuery;return a.sources={sales_nurturing:"sales_nurturing_add_product"},a.SNWelcomePopupInit=function(e){n.getJSON(SCN.Loader.getBackendUrl(a.getParam("get_sales_nurturing_products_url")),{email_id:e},function(e){if(e.success&&Object.keys(e.products).length){n.each(e.products,function(n,t){a.SNFormatProduct(t),t.is_last=n===e.products.length-1}),SCNHandlebars.registerHelper("ifCond",function(a,e,n,t){switch(e){case"&&":return a&&n?t.fn(this):t.inverse(this);case"||":return a||n?t.fn(this):t.inverse(this);default:return t.inverse(this)}});var t=SCNHandlebars.templates.sales_nurturing_products({owner_name:e.email.owner_first_name||null,products:e.products});a.SNShowPopup(t)}})},a.SNFormatProduct=function(t){var r=e.Product.convertDataToInstance(t),o=[];n.each(t.variants,function(n,t){var s=e.Variant.convertDataToInstance(r,t);0==SCN.Cart.isHiddenVariant(s)&&(a.SNFormatProductVariant(t),o.push(t))}),t.variants=o,t.select_variant=t.variants.length>1,t.single_variant=t.variants[0],t.single_variant.price_format=e.Money.formatMoney(t.single_variant.price,SCN.Config.moneyFormat),t.single_variant.compare_at_price_format=e.Money.formatMoney(t.single_variant.compare_at_price,SCN.Config.moneyFormat),t.single_variant.compare_at_price==t.single_variant.price&&(t.single_variant.compare_at_price=0)},a.SNFormatProductVariant=function(a){a.price*=100,a.compare_at_price*=100},a.SNShowPopup=function(e){var t=n("#bk-sn-welcome-container");t.length?t.append(e):(t=n('<div id="bk-sn-welcome-container" style="display: none"></div>'),t.append(e),n("body").append(t)),n("#bk-sn-welcome-a").fancybox({wrapCSS:"bk-sn-welcome-wrap bk-normalize",closeClick:!1,helpers:{overlay:{closeClick:!0}},openMethod:"dropIn",openSpeed:250,closeMethod:"dropOut",closeSpeed:150,afterLoad:a.SNAfterLoad,beforeClose:function(){},afterClose:function(){}}).click()},a.SNAfterLoad=function(){SCN.Config.isCurrencySwitcher&&n(document.body).trigger("switch-currency");var t=n("#bk-sn-welcome");n(".bk-selection",t).change(function(){var a=n(this).find(":selected"),t=parseFloat(a.data("price")),r=parseFloat(a.data("compare")),o=n(this).closest(".sn-product");o.find(".bk-price").html(e.Money.formatMoney(t,SCN.Config.moneyFormat)),o.find(".bk-compare").html(e.Money.formatMoney(r,SCN.Config.moneyFormat))}),n(".sn-remove",t).click(function(){var a=n(this),e=a.closest(".sn-product");e.hide("fast",function(){n(this).remove(),0==n(".sn-product",t).length&&n.fancybox.close()})}),n(".cancel",t).click(function(a){a.preventDefault(),n.fancybox.close()}),n(".sn-checkout-button",t).click(function(t){e.Ajax.addItemFromForm(n("#bk-sn-products-welcome").serialize(),function(a){if("object"!=typeof lineItem)return e.Page.forceGoToCheckoutPage(),void 0;var n,t,r,o=e.Cart.getCurrentCart(),s=o.getItemsManager(),c=e.CartItem.convertDataToInstance(a),i=c.getVariantId(),l=s.findCartItemById(i);n=l?l.getQuantity():0,t=c.getQuantity(),r={product_id:c.getProductId(),variant_id:c.getVariantId(),sku:c.getSku()},r.quantity=Math.abs(n-t),r.cart_token=o.getToken(),r.sources=e.Tracker.Cart.getSources(),t>n?"undefined"!=typeof SCN.Config.events.product&&e.Tracker.track(SCN.Config.events.product.ADD_TO_CART,r,function(){e.Tracker.Cart.clearSources(),e.Page.forceGoToCheckoutPage()}):n>t&&"undefined"!=typeof SCN.Config.events.product&&e.Tracker.track(SCN.Config.events.product.REMOVE_FROM_CART,r,null)},a.sources.sales_nurturing),t.preventDefault()})},a});